---
title: "COVID-19 in the World"
author: "Nathan Gaynor, Kayleigh Habib, Zoya King, George Mandl"
date: "12/12/2020"
output:
  html_document:
    toc: true
    theme: cerulean
  pdf_document: 
    fig_caption: true
    number_sections: true
---

```{r setup, include=FALSE }
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      message = FALSE,
                      fig.width = 4, fig.height= 3)
library(tidyverse)
library(stringr)
library(lubridate)
library(maps)
library(kableExtra)
library(broom)
library(modelr)
library(dplyr)
library(rmarkdown)
library(gridExtra)
```



```{css, echo = FALSE}
caption{
  color: black;
  font-weight: bold;
  font-size: 60px
  text-decoration-line: underline;
  text-align: center;
  }
```


```{r, team}
team <- tibble(`Last Name (Family)` = c("Gaynor", "Habib", "King", "Mandl"),
                   `First Name (Given)` = c("Nathan", "Kayleigh", "Zoya", "George"),
                   `Student ID` = c("170586250", "200370580", "203240570","200655330"))

teamName <- "Team Name : TrendSetters"


team %>% mutate(`Last Name (Family)`  = cell_spec(`Last Name (Family)` , format = 'html',
                                 bold = ifelse(`Last Name (Family)`  == "Habib", TRUE, FALSE))) %>% 
          kable(align = 'l', escape = FALSE, caption = teamName) %>% 
          kable_styling(bootstrap_options = 'bordered', full_width = TRUE) %>% 
          row_spec(row = c(0:4), extra_css = 'border: 1px solid')
          
```

```{r, function}
#Function to make tables for presentation in report

tableFunction <- function(data, title){  #identify parameters
  data %>% 
    kable(format = "html", 
          caption = title,
          row.names = FALSE, align = c("l",  rep('r', ncol(data)-1))) %>% 
    kable_styling(full_width = TRUE)  
}

```




# Introduction to COVID-19

In late 2019, reports of an infectious respiratory illness began to emerge from China. While its origin is unclear, and is outside the scope of this analysis, the lack of information and methods of treatment raised alarms in many other parts of the world. Caused by the severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2), the disease has become widely referred to as COVID-19.

On March 11, 2020, the World Health Organization (WHO) officially declared COVID-19 to be a pandemic, based on its definition of “worldwide spread of a new disease”. At that time, there were just 118,000 cases worldwide, with 90% of the cases concentrated in 4 countries. Over the past 8 months, COVID19 has infected over 53 million people, and caused over 1.3 million deaths in over 220 countries worldwide.

```{r, worldmap}
#Read in data file with covid cases
covid_cases <- read_csv("https://covid.ourworldindata.org/data/ecdc/full_data.csv",
                        col_types = cols(
                          .default = col_double(),
                          date = col_date(format =""),
                          location = col_character(),
                          new_cases = col_double(),
                          total_cases = col_double()
                        ))

# Find total claims by location on specified date
Covid_Oct28 <- covid_cases %>% 
  filter(date == "2020-10-28") %>% 
  group_by(location, total_cases) %>% 
  select(location, total_cases, total_deaths) %>% 
  filter(location != "World")

# Fix name of significant location to ensure match
Covid_Oct28$location <- str_replace(Covid_Oct28$location,
                                    "United States",
                                    "USA")


# Load data from map of world
world <- map_data("world")

# Include only those locations found in both sets of data
Covid_Oct28 <- Covid_Oct28 %>% 
  semi_join(world, by = c("location" = "region"))

# Map Data ------------------------

# Create blank map of the world
map1 <- ggplot() +
  geom_map(data = world, map = world,
          mapping = aes(x = long, y = lat, map_id = region),
          fill = "#ffffff", color = "#ffffff", size = 0.20)

# Add data for total cases on specified date 
map_cases <- map1 + 
  geom_map(data = Covid_Oct28, map = world,
      mapping = aes(fill = total_cases, map_id = location),
      color = "#ffffff",  size = 0.15)

map_deaths <- map1 + 
  geom_map(data = Covid_Oct28, map = world,
      mapping = aes(fill = total_deaths, map_id = location),
      color = "#ffffff",  size = 0.15)

# Add shading to show variation of cases
map_total_cases <- map_cases +
  scale_fill_continuous(low = 'lightgreen', high = 'darkblue',
  guide = 'colorbar') +
  ggtitle("Total COVID-19 Cases - Oct 28, 2020")

map_total_deaths <- map_deaths +
  scale_fill_continuous(low = 'lemonchiffon2', high = 'red',
  guide = 'colorbar') +
  ggtitle("Total COVID-19 Deaths - Oct 28, 2020")


# Display map
map_total_cases
map_total_deaths

```


The maps show that while this is a global health crisis, the levels of infection as well as the fatality rates vary widely by region, country, and even within countries. For example, there is a significant difference in experience among provinces in Canada, based on demographics and level of urbanization. 



### How Countries Responded
In response to the pandemic declaration, many governments around the world began to implement various measures to control the spread of the disease, to reduce the strain on their health systems, and to provide economic relief for citizens adversely impacted by these measures.

Detection of the extent of the virus is dependent on the level of testing within a country. Effective testing allows public health authorities to identify COVID-19 cases and outbreaks and implement contact tracing and quarantining procedures to limit the spread. These statistics also help frame appropriate government response measures.

The extent and effectiveness of any of these measures depended on level of compliance among the population, status of the healthcare system within a country, and availability of resources to be able to implement such measures.


## Factors Analysed
While there are many different factors that impact or are impacted by the infection rate and the fatality rate of the virus within different regions, this report will be limited to the following:

* Political : Given the different types of government around the world, the impact of COVID-19 infection and fatality rates will also be varied. It is expected that countries in which any government responses are complied with, either forcefully or voluntarily, would have more favourable experience. On the other hand, if government systems are unstable, or the population is more inclined to reject government-imposed restrictions, experience would be adverse.

* Economic: The COVID-19 pandemic has had a significant impact on the economies of nearly all countries of the world. It can also be expected that different economic situations could affect COVID infection and fatality rates of various countries. Some countries may have been hit harder by the pandemic than others due to their expenditures of their GDPs. It could also be possible that countries with large economies could be reluctant to go into lockdown since it could result in economic recession and be potentially devastating to its economy. We hope to discover connections between COVID-19 and economy through trends in the datasets healthexp and educationexp.  

* Employment : The COVID-19 pandemic has greatly impacted the employment rate of many countries around the world. It can be assumed that employment could be affected by the COVID infection and fatality rates in each country. Different countries have been impacted by the pandemic in various ways, as some may have been hit harder than others. In the case of employment, some countries shutdown their economy faster than others which may have dropped the infection/fatality rates quicker leading to less job loss. While other countries are still struggling to lower the infection/fatality rates causing longer economic shutdowns and more job losses as many businesses have had to close.

* Technology : The impact of COVID-19 has played a major role as it relates to technology. It may be assumed that countries with not that much access to the internet or technology may have a challenge as it may be difficult for them to be updated on fatality rates and recoveries within their country and by extension the world. One can assume that for smaller, less developed countries, persons might be unaware of some of the updates across the world, or unable to adjust to remote working due to technology limitations. Hence playing a major role in the technology aspect of things.  


## Dates Selected and Data Sets
For this analysis we chose to look at infection and fatality rates for the period starting **March 12, 2020** to **October 28, 2020**. The starting date of March 12 for our study provides a glimpse of the state of the virus across the world just after the WHO declared the disease a pandemic, and allows for the measure of its progress almost from the starting point for many countries. The ending date of October 28 allows us to examine the course of the virus over a period that is long enough to determine and trends, but also provides a cut-off date that takes into account lags in reporting of data. 

* COVID-19 cases
   - This dataset contains 10 variables and provides information on the number of COVID cases and deaths reported by country, and is updated daily from December 31, 2019 to the current date. The numeric values include cumulative totals, as well as daily, weekly and bi-weekly new cases and deaths. The data was obtained from the World Health Organization (WHO), the European Centre for Disease Prevention and Control (ECDC) and more recently, the Johns Hopkins University, all of which are recognized and reliable data sources.
* COVID-19 testing
  - This dataset contains 14 variables and provides information on the number of COVID tests by country, for the period starting January 1, 2020 to the current date. The data includes numeric values for the cumulative tests and the daily change in the number of tests, the cumulative testing rate per thousand of population and the daily change in that rate, the 7-day average testing rate per thousand of population and the change in that rate. The data also includes a short-term positivity rate and the number of tests per case, which provide an indication of the proportion of total tests that have a positive result. This information is provided by country with additional columns for country, date and source of data. Where available, information is typically sourced from government agencies within each country, and as a result, reporting methods and frequency are varied. The dataset included information on the source, as well as any relevant notes which indicate limitations or provide additional clarity on the data.
* COVID-19 government responses
  - This dataset contains 49 variables that facilitate comparing government responses. It includes a boolean indicator for each country on whether or not a measure was implemented, and if so, a ranking to indicate the severity or extent of that measure (i.e., whether localized or national).The data is collected by the University of Oxford, and includes data from January 1, 2020 to the current date. The measures are grouped as follows:
    1. Containment measures e.g., school and workplace closures, public event cancellation and restrictions on gatherings and internal movement
    2. Economic measures e.g., income support, debt/contract relief and other fiscal measures
    3. Health measures e.g., public information campaigns, testing policy, contact tracing, and facial coverings.
  - Several numerical indices are calculated for each country and date, based on the above measures, and converted to a value between 1 and 100:
    1. Government Response Index – overall level of stringency based on a combination of all measures taken and their severity
    2. Containment and Health Index – based on the containment and health measures only
    3. Economic Support Index – measures the level of stimulus provided
    4. Stringency Index – records the strictness of ‘lockdown’ measures taken.


# Political

### Data Set Analysis
For this factor, the following additional databases were used:

* Democracyindex
  - This dataset contains 167 observations and 12 variables, and provides a point-in-time view of the state of democracy in the world. The data includes for each country, a numeric score based on responses to 60 questions grouped in 5 categories which is then converted to an overall numeric Democracy Index to classify countries by type of Regime as follows:
    - Full Democracy with democracy index greater than 8
    - Flawed Democracy with democracy index between 6 and 8
    - Hybrid Regimes with democracy index between 4 and 6
    - Authoritarian Regimes with democracy index lower than or equal to 4.
  - The data and scores were collected and calculated by the Economist Intelligence Unit, a division of the world recognized Economist Group which provides research and analysis on economic and political affairs.

* Population
  - This dataset contains 238 observations and 4 variables and provides estimates of the total population of each country based on population census data, as well as surveys and projections based on past statistics. For the majority of countries, the most recent data contains population estimates for July 2020. The data is compiled by the Central Intelligence Agency and presented as part of the World Factbook project.
  
*System of Government*
Using the Democracy Index data collected by the Economist Intelligence Unit, governments can be classified into the following regime types, based on their overall “democracy score”.


```{r, load data}
#
#Load data from [democracy index](https://www.eiu.com/ #topic/democracy-index) developed by the [Economist #Intelligence Unit](http://www.eiu.com/home.aspx), which is #contained in the table from the [Wikipedia #page](https://en.wikipedia.org/wiki/Democracy_Index).

democracyindex <- read_tsv("DEMOCRACYINDEX.csv")

#Load population data from [Population in the region](https://www.cia.gov/library/publications/resources/the-world-factbook/fields/335rank.html)
population <- read_tsv("POPULATION.csv") 

#Fix country name
population$Country <- str_replace(population$Country, "Czechia", "Czech Republic")

#Combine democracy and population data
democracy_covid <- democracyindex %>% 
  # keep only records found in both sets of data
  left_join(population, by = "Country") %>% 
  # specify columns to keep in data
  rename(RegimeType = "Regime type") %>% 
  select(Country, Score, RegimeType, Population)

#Create table for population by regime type
regimes <- democracy_covid %>% 
  
  select(-Score) %>% 
  group_by(RegimeType) %>%
  summarise(Num_Countries = n(),
            TotalPop = sum(Population, na.rm = TRUE),
              .groups = "drop") %>% 
  mutate(Prop_Countries = paste(round(Num_Countries/sum(Num_Countries)*100, 1), "%"),
         Prop_Population = paste(round(TotalPop/sum(TotalPop)*100, 1), "%")) %>% 
  arrange(Prop_Countries)

#Display table using function
tableFunction(regimes, "Systems of Government")


```

As can be seen, there are 4 main types of political regimes, with the majority of the world's population belonging to Flawed Democracies.


In *authoritarian* countries, there is strong enforcement of government impose measures, with heavy penalties imposed on individuals who do not comply. In such regions, personal freedoms are denied in favour of social benefits.

In *fully democratic* countries, the degree of enforcement is much lower. However, due to the level of trust and openness within society, citizens are more likely to voluntarily comply with restrictions as they clearly see the benefit of these measures to their overall well-being.

In *flawed democracies*, where misinformation is widespread and there is a high level of distrust of the government and the media, a large portion of citizens believe these restrictions are an infringement on their personal freedoms.  

*Hybrid regimes* represent a combination of authoritarian rule and democratic systems, and usually have a high level of corruption and lack of free and fair elections.

Given the differences in systems of government, it is likely that the incidence rates of COVID-19 within a country would depend on the government structure, its ability to respond effectively to the pandemic, and the level of public support. 


### Approach Used
To determine the relationship between government system and COVID-19 infection and mortality rates, several data sources were used. As some of the information in these sources was inconsistent or incomplete, the analysis is based on the top 60  countries based on total COVID-19 reported cases at October 28, 2020.
The dataframe was developed by combining information from the COVID-19 cases data, with population counts, government response data, COVID-19 testing statistics, and democracy indicator.

```{r, covidtop60}
# Load COVID-19 case data

#Take top 60 countries by total number of covid cases at Oct 28, 2020
covid_top60 <- covid_cases %>%
  filter(date == "2020-10-28",
         location != "World") %>%
  select(-c(starts_with("biweekly"))) %>% 
  arrange(desc(total_cases)) %>%
  slice(1:60) 
```



```{r, govresponse}
#Load and filter government response data
#Load data from [COVID-19 government responses](https://www.bsg.ox.ac.uk/research/research-projects/coronavirus-government-response-tracker#data)

#University of Oxford, Blavatnik School of Government, "Coronavirus government response tracker"

covid_response <- read_csv("https://raw.githubusercontent.com/OxCGRT/covid-policy-tracker/master/data/OxCGRT_latest.csv",
                           col_types = cols(
                             .default = col_character(),
                             Date = col_date(format = "%Y%m%d"),
                             `E3_Fiscal measures` = col_double(),
                             `E4_International support` = col_double(),
                             `H4_Emergency investment in healthcare` = col_double(),
                             `H5_Investment in vaccines` = col_double(),
                             `C1_Flag` = col_logical(),
                             `C2_Flag` = col_logical(),
                             `C3_Flag` = col_logical(),
                             `C4_Flag` = col_logical(),
                             `C5_Flag` = col_logical(),
                             `C6_Flag` = col_logical(),
                             `C7_Flag` = col_logical(),
                             `E1_Flag` = col_logical(),
                             `H1_Flag` = col_logical(),
                             `H6_Flag` = col_logical(),
                             `StringencyIndex` = col_double(),
                             `GovernmentResponseIndex` = col_double(),
                             `ContainmentHealthIndex` = col_double()
                           ))

covid_response_filter <- covid_response %>% 
  filter(Date == "2020-10-28") %>% 
  filter(is.na(RegionCode)) 

```


```{r, covidtests, results='hide'}
#Load and filter testing statistics

covid_tests <- read_csv("https://covid.ourworldindata.org/data/testing/covid-testing-all-observations.csv")

rows_to_exclude <- c("Argentina - people tested", "Italy - people tested", "Poland - people tested", "Singapore - people tested", "United States - units unclear")

covid_tests_filter <- filter(covid_tests, !(Entity %in% rows_to_exclude))

covid_tests_filter <- covid_tests_filter %>% 
  separate(Entity, into = c("Country", "Unit"), sep = " - ") %>% 
  select(c(Country, Date, `Cumulative total`, `Daily change in cumulative total` )) 

#Fix country name
covid_tests_filter$Country <-  str_replace(covid_tests_filter$Country,"Czechia", "Czech Republic")

covid_tests_daily <- covid_tests_filter %>% 
  filter(Date <= "2020-10-28") %>% 
  group_by(Country) %>% 
  summarise(TotalDaily = sum(`Daily change in cumulative total`, na.rm=TRUE),
            .groups =  "drop") 

covid_tests_cumul <- covid_tests_filter %>% 
   filter(Date <= "2020-10-28") %>% 
  group_by(Country) %>% 
  summarise(CumulTests = max(`Cumulative total`, na.rm=TRUE),
            .groups= "drop")%>% 
  mutate(CumulTests = ifelse(is.finite(CumulTests), CumulTests, NA))

covid_tests_final <- covid_tests_daily %>% 
  left_join(covid_tests_cumul, by = "Country") %>% 
  mutate(TotalTests = ifelse(is.na(CumulTests), TotalDaily, CumulTests))%>% 
  select(c(Country, TotalTests))

```

```{r, datajoins}
# Join datasets
#Join to population data
covid_top60 <- covid_top60 %>% 
  left_join(population, by = c("location" = "Country")) %>% 
  select(-c(Rank, "Date of Information"))

#Join to response data
covid_top60 <- covid_top60 %>% 
  left_join(covid_response_filter, by = c("location" = "CountryName")) %>% 
  select(-c(CountryCode:Date, ConfirmedCases, ConfirmedDeaths, ends_with("Display")))

#Join to testing data
covid_top60 <- covid_top60 %>% 
  left_join(covid_tests_final, by = c("location" = "Country"))
  
#Join to democracy index
covid_top60 <- covid_top60 %>% 
  left_join(democracyindex, by = c("location" = "Country")) %>% 
  select(-c(Rank, starts_with("Change")))
```

### Analysis

#### Extent of COVID-19  by System of Government

Infection rates varied by country, with many parts of the world experiencing relatively high cases counts. The following summary shows the summary of descriptive statistics for the overall Infection Rate. As the mean is greater than the median, the data is right-skewed, implying that there are some outliers with larger infection rates.

```{r, inf and mort}
covid_top60 <- covid_top60 %>% 
  mutate(InfRate = total_cases / Population * 1000,
         MortRate = total_deaths / total_cases,
         NewInfRate = weekly_cases / Population *1000,
         NewMortRate = weekly_deaths / weekly_cases)

#Descriptive Statistics for Infection Rate
summary(covid_top60$InfRate)

covid_top60_grp <- covid_top60 %>% 
  group_by(`Regime type`) %>% 
  summarise(InfRate_perThousand = round(sum(total_cases)/ sum(Population) * 1000, 2),
            MortRate = paste(round(sum(total_deaths)/ sum(total_cases) * 100, 2), "%")
                             , .groups = "drop")

tableFunction(covid_top60_grp, "Infection and Mortality Rates by Government Type")

```

The table above illustrates the infection and mortality rates by system of government. This shows that countries with more democratic systems of government fared worse during the pandemic, as the infection rate per thousand of population was almost 5 times higher than for Authoritarian and Hybrid regimes. Mortality rates (number of COVID-19 tests / number of cases) were more consistent, although still higher for democratic countries.


#### COVID-19 Response by System of Government

The rate of spread of the virus can partly be attributed to the types of containment and health measures put in place by each country. Government responses to the pandemic varied not only by types of measures, but also by the degree or extent of application.

Countries introduced a combination of measures to curb the spread of the disease in order to protect their citizens. The following table summarizes the number of countries implementing specific measures.

```{r, fig.width = 7, fig.height= 5, fig.align='center'}

covid_top60_test <- covid_top60 %>% 
  select(c(`Regime type`, C1_Flag, C3_Flag, C4_Flag, C7_Flag, H1_Flag, H6_Flag)) %>% 
  rename(SchClose = C1_Flag,
         WorkClose = C3_Flag,
         Gather = C4_Flag,
         Movement = C7_Flag,
         PubInfo = H1_Flag,
         Masks = H6_Flag) %>% 
    gather("SchClose", "WorkClose", "Gather", "Movement", "PubInfo", "Masks", key = "Response", value = "Indicator") %>% 
  group_by(`Regime type`, Response) %>% 
  summarise(Indicator = mean(Indicator, na.rm=TRUE)) 


  ggplot(covid_top60_test)+
  geom_bar(mapping = aes(x= Response, y =Indicator, fill = `Regime type`), stat = "identity", position = "dodge") +
  theme(axis.text.x = element_text(angle = 30, vjust =0.5, hjust=0.5)) +
    ggtitle("Containment and Health Measures by Government Type")

```

Containment measures that included School and Workplace Closures, were put in place by at least 75% of Authoritarian countries, compared to less than 60% of Flawed democracies. While public information campaigns were adopted by almost all countries, only 75% of democratic countries introduced mandatory facial coverings, while this proportion was almost 90% for Authoritarian and Hybrid regimes combined.

The Government Response data collected by the University of Oxford records presence of specific measures as well as their severity. For example, if a government implemented restrictions on mobility, they may apply to the entire country, or for a specific region within that country where COVID-19 cases were more prevalent. The types of measures also varied at different points during the study period, depending on the level of infection.
The severity of combined measures is determined by the Stringency Index, which applies weightings to each measure based on level of intensity. Similar indices are also provided for Containment and Health measures, Economic measures, and overall Government response.
The following boxplot shows the stringency index by type of government system.

```{r, fig.width = 7, fig.height= 3}
ggplot(data = covid_top60, mapping = aes(x = `Regime type`, y = StringencyIndex)) +
  geom_boxplot()+
  coord_flip() +
  ggtitle("Stringency Index by Government Type")

```

These charts show the variation in stringency levels by regime type: 
1. The median stringency index was lowest in Authoritarian regimes.
2. The interquartile range was widest for Authoritarian and Hybrid Regimes, indicating wider variability in response.
3. While Authoritarian, Hybrid and Full Democracies are more right-skewed, Flawed Democracies are the opposite. 


#### COVID-19 Testing by System of Government

COVID-19 testing statistics are based on data collected by the World in Data project, which records reports provided by government agencies within each country. As these sources are not consistent, there is some variation in the completeness and frequency of reporting, as well as what the underlying data represents. For example, countries may report number of unique tests, while other provide total tests, including multiple tests on the same individual.

The accurate reporting of the incidence of COVID-19 within a country depends on the level of testing being carried out. Initially, these levels would have been low as countries worked to develop and distribute testing kits, and resources to perform tests and process results. Detection of COVID-19 infection rates and effective contact-tracing would be measures that would help in determining the appropriate government response.


```{r,fig.width = 8, fig.height= 3, fig.align= 'center'}

covid_top60 <-covid_top60 %>% 
  mutate(TestRate = TotalTests /Population * 1000) 

ggplot(data = covid_top60)+
  geom_point(mapping = aes(x=TestRate, y = MortRate, colour = `Regime type`)) +
  xlim(c(0,600))+
  ggtitle("COVID-19 Mortality vs Testing Rate by Government Type ")

```


Testing rates are much higher in Authoritarian and Full democracies compared to the other 2 systems of government. Adequate testing helps identify positive COVID-19 cases, and allows public health authorities to implement contact tracing and quarantine measures that can help curb the spread of the virus.

#### Relationship between Type of Government and COVID rates

```{r, democmodel}
# Create linear model
my_model <-
  lm(NewInfRate~Score,covid_top60)


model_summary <- my_model %>% tidy()
tableFunction(model_summary, "Model Statistics")

covid_top60 <- covid_top60 %>% 
  add_predictions(my_model) %>% 
  add_residuals(my_model)

paste0("R-squared value = ", round(summary(my_model)$r.squared,2))


#Plot the variables and model
d1 <- ggplot(data = covid_top60, mapping = aes(x = Score,  y = NewInfRate)) +
  geom_point()+
  geom_smooth(method = "lm")+
  labs(title ="Infection Rate vs Democracy Score", subtitle = paste("Cor Coeff = ", cor(covid_top60$NewInfRate, covid_top60$Score))) 


#Plot residuals to look for any patterns
d2 <- ggplot(data = covid_top60,mapping = aes(x = Score , y = resid))+
  geom_point()+
  geom_smooth(method = "lm")+
  ggtitle("Residuals vs Democracy Score")

```

```{r, fig.width = 10, fig.height= 4}
grid.arrange(d1, d2, ncol=2)
```

This shows that there is a positive linear relationship between the rate of new infections and the system of government as determined by the democracy score, with a correlation coefficient of 0.39. The p-value is 0.018, indicating that it is a moderately significant variable.
Based on the R-squared value, this model shows that about 15% of the variation in infection rate can be attributed to the democracy score. Therefore, there are other factors that impact infection rates.

### Findings
Based on the analysis above, it appears that there is a weak relationship between government system and level of COVID-19 infection. Authoritarian government systems appear to have been more successful at controlling the level of new infections, likely because they exercise more control over their citizens. In contrast, democratic countries have been less successful at controlling the virus levels despite the containment measures that were put into place. For these countries, it is likely that citizens are more accustomed to a certain level of freedom, and enforcement of strict measures was more difficult. While the model can detect patterns in data, it is difficult to account for individual social behaviours, particularly when personal choice is highly prevalent.  

# Economic

### Data Set Analysis

* healthexp
  - The data set ‘healthexp’ contains 3 variables and 190 observations. The first variable, ‘Country’, is of type character and contains the full name of the country. The second variable is ‘Current Health Expenditure’ which contains the health expenditure of the country as a percentage of its economy and is a character vector. The last variable is ‘year’, which contains the year in which the observation was recorded and is type double. My assumption would be that higher health expenditure would result in less significant COVID implications. Research question: Does higher health expenditure cause lower COVID cases and deaths and higher recovery rates?

* educationexp
  - A data set ‘educationexp’ contains 4 variables and 173 observations. ‘Country’ is a character variable and contains the full names of the observation’s countries. ‘(% of GDP)’ is a double variable and contains the education expenditure as a percent of the total GDP of an observation. The variable ‘Rank’ is type double and contains the rank of the observations based on the ‘(% of GDP)’ variable. The ‘Date of Information’ is a double variable and contains the year in which the observation was last updated. One may assume that as the education expenditure increases then they would have less money for health services. Therefore, a higher education expenditure may result in larger COVID implications. Research question: Does higher education expenditure cause higher COVID cases and deaths and lower recovery rates?
	
	
### Single Variable Analysis

```{r}
educationexp <- read_tsv("EDUEXP.csv")
educationexp<-educationexp %>% 
  rename("percentGDP"="(% OF GDP)","Year"="Date of Information")
educationexp1<-educationexp %>% 
  filter(percentGDP<10)
p1 <- educationexp1 %>% 
  ggplot(mapping = aes(x=percentGDP))+
  geom_boxplot()
```


```{r}
healthexp<- read_tsv("HEALTHEXP.csv")
healthexp1<-healthexp %>% 
  rename("Healthexpenditure"="Current Health Expenditure") %>% 
  mutate(Healthexpenditure=str_remove_all(Healthexpenditure, "\\%"),
         Healthexpenditure=as.double(Healthexpenditure))
healthexp2<-healthexp1 %>% 
  filter(Healthexpenditure<100)
p2 <- ggplot(data=healthexp2, mapping = aes(x=Healthexpenditure))+
  geom_boxplot()
```


```{r}

COVID_casesMar12<-covid_cases %>% 
  filter(date=="2020-03-12",location!="World",!is.na(total_cases)) %>% 
  select(location, new_cases,new_deaths,total_cases,total_deaths)
COVID_cases1Mar12<-COVID_casesMar12 %>% 
    mutate(total_deaths=ifelse(is.na(total_deaths),0,total_deaths),
    deathrate=(total_deaths/total_cases)*100,
    recoveryrate=100-deathrate,
    deathrate=round(deathrate,digits=1),
    recoveryrate=round(recoveryrate,digits=1))
COVID_cases2Mar12<-COVID_cases1Mar12 %>% 
  filter(total_cases<1500)
p3<- COVID_cases2Mar12 %>% 
  ggplot(mapping = aes(x=total_cases))+
  geom_boxplot()
```


```{r, fig.width = 10, fig.height= 5}
#added this for the grid display
grid.arrange(p1, p2, p3, ncol=2)
```


*educationexp*

The set contains 4 outliers all of which are on the right/top of the data. These points skew the data and therefore will be removed for more accurate conclusions. From visual analysis of the boxplot the middle quartiles of the set seem to be almost even, and the whisker of the box plots seem fairly even too. The standard deviation of education expenditure is 2.14 including the outliers and 1.81 excluding. This gives further justifications on why they should be removed, the standard deviation decreases by 15%, meaning the data becomes less spread out, when the 4 outliers are removed. The mean of the data is 4.85 and the median is 4.7 which means that the data has a slight positive skew. The outliers mentioned before seem to have some responsibility for this.

*healthexp*

The data set contains 6 outliers one of which is an extreme outlier that will be removed since it is unrealistic and provide little insight for future trends and conclusions. This is the observation of the Democratic Republic of Congo and its health expenditure is 403% of its GDP which is extremely unrealistic and skews the data incredibly. The observations contain the country Iran is also removed since it does not have any data for Current Health Expenditure. After these removals, the mean of the Current Health Expenditure is 6.81 and the median is 6.3. The data has a slight positive skew since its mean is greater than its median which is likely caused by the outliers on the right end of the data. The standard deviation of the Current Health Expenditure is approximately 2.9 which is relatively large given that the IQR is only 3.4. 

*COVID_cases: March 12*

The total cases on the other will be a more accurate than total deaths at this stage in the pandemic since most countries will have cases but few, if any, deaths. There are some countries in which the pandemic was already in a different stage of the pandemic which would result in extreme outliers in the dataset. The aim of using the March date is to see a country's early COVID-19 trends. Therefore, some of these outliers should be removed so we are able to focus more on the core of the data. I have decided to remove the observations with more than 1,500 total cases. The remaining data is positive skewed with a median of 25 and a mean of 114.1. The data is very spread out with a standard deviation of 228.57 which is likely caused by the outliers. The recoveryrate variable is inaccurate for the March 12th day since it is are dependent on total_deaths, which at this stage in the pandemic is not accurate.


*COVID_cases: October 28*

There are 3 observations in the total_cases variable that are extreme outliers and are skews the data immensely. These observations should be removed to increase the accuracy of the trends. By removing these observations, the data becomes less skewed. 

```{r}
COVID_casesOct28<-covid_cases %>% 
  filter(date=="2020-10-28", location!="World") %>%
  select(location, new_cases,new_deaths,total_cases,total_deaths)
COVID_cases1OCT28<-COVID_casesOct28 %>% 
  mutate(total_deaths=ifelse(is.na(total_deaths),0,total_deaths),
         deathrate=(total_deaths/total_cases)*100,
         recoveryrate=100-deathrate,deathrate=round(deathrate,digits=1),
    recoveryrate=round(recoveryrate,digits=1))
COVID_cases2OCT28<-COVID_cases1OCT28 %>% 
  filter(total_cases<250000, deathrate<20)
p4<- COVID_cases2OCT28 %>% 
  ggplot(mapping = aes(x=total_cases))+
  geom_boxplot()
```

The recovery rate contains one usual data point which contains a country that has a nearly 30% deathrate which is significantly different from the other observations. Removing this observation results in the data being less skewed. 

```{r}
p5 <- COVID_cases2OCT28 %>% 
  ggplot(mapping = aes(x=recoveryrate))+
  geom_boxplot()
```

```{r, fig.width = 10}
#added this for the grid display
grid.arrange(p4, p5, ncol = 2)
```

### Two Variable Analysis

*Healthexp & COVIDMAR12*

The graph shows the relationship between Healthexpenditure and the resulting total cases upon until March 12. There seems to be a positive linear relationship: as the percentage of GDP allocated to health increases so do the number of COVID cases. This information seems confusing since one might assume that more money spent on health would result in fewer COVID cases. The correlation of the variables approximately 0.59 which shows a moderate positive correlation as seen in the plot. The covariation is 360, which is exceptionally high due to some outliers in the total_cases variable. The linear model of the variable appears significant since the p-value is very close to 0 but the fit is not very good as the R-squared value is only 0.34. 

```{r}
healthexpCOV12<-left_join(COVID_cases2Mar12,healthexp1, by=c("location"="Country"))
healthexp1COV12<-healthexpCOV12 %>% 
  filter(!is.na(Healthexpenditure))
g1 <- healthexp1COV12 %>% 
  ggplot(mapping = aes(x=Healthexpenditure,y=total_cases))+
  geom_point()+
  geom_smooth(method = 'lm')
```

*Healthexp & COVIDOCT28*

The graph of Healthexpenditure and the total_cases on October 28 still shows a positive relationship but to less of a degree and less accuracy. The correlation coefficient is only 0.05 meaning there is a weak positive relationship and the covariation a lot higher than it was in March. The p-value is also much larger whereas the R-squared value is much smaller, which signifies that the linear model is far less accurate. Overall, the trends from March to October have changed significantly. The relationship was much stronger in March and there was less covariation in the variables. 


```{r}
healthexpCOV28<-left_join(COVID_cases2OCT28,healthexp1, by=c("location"="Country"))
healthexp1COV28<-healthexpCOV28 %>% 
  filter(!is.na(Healthexpenditure))
g2 <- healthexp1COV28 %>% 
  ggplot(mapping = aes(x=Healthexpenditure,y=total_cases))+
  geom_point()+
  geom_smooth(method='lm')
```

The graph of Healthexpenditure and recovery rate of COVID cases shows a negative linear correlation. The correlation coefficient is -0.23 which means that there is a weak negative correlation meaning that as healthexpenditure increases the recovery rate decreases which is once again unusual. The covariance in -0.95, the p-value is 0.05 and the R-squared is 0.05 which shows that there could be other information that may improve the model fit.

```{r}
g3 <- healthexp1COV28 %>% 
  ggplot(mapping = aes(x=Healthexpenditure,y=recoveryrate))+
  geom_point()+
  geom_smooth(method='lm')
```

Overall, the healthexpinditure shows that the higher percentage of a country's GDP that is spent on healthcare results in negative effects on its COVID cases, deaths, and recovery rates. Although all variables show the same pattern but many of the correlation coefficients show weak relationship and there are inaccuracies shown in the linear models and covariation. 

*Educationexp & COVIDMAR12*

The graph between the variables percentGDP and total_cases shows a positive linear relationship. A correlation coefficient of 0.25 signifies a slightly weak positive linear relationship between the two variables which is understandable because if a country spends more money on education then it has less to spend on health which could causes higher COVID infection and cases. The covariance is 99.39 and shows the spread of the data points is fairly small. The linear model is a poor fit since its R-squared is very low but so is the p-value.

```{r}
educationexpCOV12<-left_join(COVID_cases2Mar12,educationexp1,by=c("location"="Country"))
educationexp1COV12<- educationexpCOV12%>% 
  filter(!is.na(percentGDP))
g4 <- educationexp1COV12 %>% 
  ggplot(mapping=aes(x=percentGDP,y=total_cases))+
  geom_point()+
  geom_smooth(method = 'lm')
```

*Educationexp & COVIDOCT28*

From the graph it is difficult to see whether the linear relationship between percentGDP and total_cases is positive and negative. The correlation coefficient is nearly 0 which shows an extremely weak positive correlation. The covariance is also fairly large which shows that the data points are pretty spread out. The linear model does not seem to explain all the variation as the R-squared very close to 0 and a p-value close 1. The difference between the relationship of these variables in October vs March is that the strength of the correlation has decreased by a lot and the covariance has increased as well. 

```{r}
educationexpCOV28<-left_join(COVID_cases2OCT28,educationexp1,by=c("location"="Country"))
educationexp1COV28<- educationexpCOV28 %>% 
  filter(!is.na(percentGDP))
g5 <- educationexp1COV28 %>% 
  ggplot(mapping=aes(x=percentGDP))+
  geom_point(mapping = aes(y=total_cases))+
  geom_smooth(mapping=aes(y=total_cases),method = 'lm')
```

The graph of percentGDP and recovery shows a very small positive linear correlation. The correlation coefficient is 0.01 which shows a very weak positive linear relationship. This relationship is not very accurate but nevertheless, one would assume a negative relationship since higher education expenditure would result in a lower recovery rate. The data's spread is not very large, which is good, as its covariance in only 0.3. The linear model is inaccurate since the R-squared is very close to 0 and the p-value is fairly close to 1.


```{r}
g6 <- educationexp1COV28 %>% 
  ggplot(mapping=aes(x=percentGDP))+
  geom_point(mapping = aes(y=recoveryrate))+
  geom_smooth(mapping=aes(y=recoveryrate),method = 'lm')
```

```{r, fig.width = 10, fig.height= 7}
#added this for the grid display

grid.arrange(g1, g2,g3,g4,g5,g6, ncol=2)
```

### Findings
Based on the results of the data analysis, there seems to be very little correlation between economic trends in relation to COVID-19. When comparing the COVID data on the dates March 12 to October 28, one is able to conclude that any trends seen in the early stages of COVID weakened or become irrelevant in the later COVID data. In the initial stages of COVID there appears to be a slight linear relationship between education expenditure of a country in relation to its COVID cases. The larger of a percentage of its GDP a country spends on education, the higher its cases were in the beginning stages of COVID. There are no recommendations that can be made based on this trend since this occurred in the initial stages and at the moment we are entering the height of our second wave. The health expenditure data for the March 12 shows an interesting trend. It shows a moderate positive correlation between COVID cases as a result of the health expenditure of a Country. The reason behind this could be that countries that spend more money on health may feel more confident in their health systems and as a result took the initial stages of COVID too lightly. In the data of second date, October 28, there seems to be absolutely no relationship between COVID cases and education exponential nor the health exponential. The correlation coefficients are all very weak and the linear models do not full explain the differences in the infection rates by contry. Overall, there do not seem to be any specific recommendations to the leaders of countries for response to COVID 19 based of economic factors and the data sets explored in this report. 


# Employment

### Data Set Analysis

* Laborforce
  - This dataset contains 16104 observations and 4 variables. The 4 variables are Country Name, Country Code, Year, and Labor Force. The integer variable ‘Year’ dates the years 1960-2020, we only examine the years after to 1989 because that is when labor force numbers started to be recorded which cuts the number of observations down to 8184. The Country Name variable is of type character and Country Code is a character variable and contains abbreviated versions from the Country Name column. The integer variable Labor force contains the value of the corresponding countries labor force in the specified year. If data is missing in the Labor Force variable for a year it is filled in as NA.

* Unemp
  - This dataset contains 218 observations and 4 variables. The character type variable ‘Country’ carries the full name of countries listed in the observations. The variable Rank is of type integer and ranks the countries from lowest to highest percentage of unemployment in order. The column Percent is of type double and lists the unemployment rate in each country. The character variable ‘Date of Information’ gives us an estimated year that the data for each country's unemployment rate was taken in.

* Unempyouth
  - This dataset contains181 observations and 3 variables. The character variable country lists the full name of countries in the observations. The variable Rank is of type integer and ranks the countries from highest to lowest percentage of youth unemployment (ages 15-24) in order. The variable Percent is type double and gives us the youth unemployment rate for each country listed in the observations.


```{r}
#Load data for [Labor force data in the region](https://data.worldbank.org/indicator/SL.TLF.TOTL.IN): the up-to-date data we use.

laborforce <- read_tsv("LABORFORCE.csv",
                       col_types = cols(
                         .default = col_double(),
                         `Country Name` = col_character(),
                         `Country Code` = col_character()
                       ))

laborforce <- gather(laborforce, "1960","1961","1962","1963","1964","1965","1966","1967","1968","1969","1970","1971","1972","1973","1974","1975","1976","1977","1978","1979","1980","1981","1982","1983","1984","1985","1986","1987","1988","1989","1990","1991","1992","1993","1994","1995","1996","1997","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020", key="Year", value="Labor Force")
laborforce <- filter(laborforce, Year>2019) %>% 
  mutate(Year= as.integer(Year),
         `Labor Force`= as.integer(`Labor Force`)) %>% 
  rename(Country = "Country Name", LaborForce = "Labor Force")
#Load data for [Unemployment in the region](https://www.cia.gov/library/publications/resources/the-world-factbook/fields/220rank.html)

unemployment <- read_tsv("UNEMP.csv")
unemployment <- unemployment %>%  
  rename("UnempRate" = "(%)") %>% 
  mutate(Rank = as.integer(Rank),
         UnempRate= as.double(UnempRate))

#Load data for [Unemployment of youth in the region, ages 15-24](https://www.cia.gov/library/publications/resources/the-world-factbook/fields/373rank.html)

unemp_youth <- read_tsv("UNEMPYOUTH.csv")
unemp_youth <- unemp_youth %>% 
  rename(YouthUnempRate = "(%)") %>% 
  mutate(Rank = as.integer(Rank),
         YouthUnempRate = as.double(YouthUnempRate))
#Combining the 2020 LaborForce data with UnempRate and YouthUnempRate data
lf2020_unemployment <- laborforce %>% 
  left_join(unemployment, by="Country") %>% 
  left_join(unemp_youth, by="Country") %>% 
  select(Country, LaborForce, UnempRate, YouthUnempRate) %>% 
  na.omit()
```


To take a better look at the distribution of Labor Force globally, the data was split into 4 levels:
- Very High: given to countries with a Labor force greater than 70 million people
- High: given to countries with a Labor force between 30-70 million people
- Mid: given to countries with a Labor force between 10-30 million people
- Low: given to countries with a Labor force lower than 10 million people

Separating the countries into categories like this makes it easier for us to see how the COVID-19 pandemic affects countries with different sized Labor Forces and can analyze its effect on employment.

```{r}
LaborForce_tiers <- lf2020_unemployment %>% 
  select(Country,LaborForce)
LaborForce_tiers <- data.frame(LaborForce_tiers) %>% 
  mutate(Tier = ifelse(LaborForce>70000000, "Very High",
                        ifelse((LaborForce<70000000 & LaborForce>30000000), "High",
                        ifelse((LaborForce<30000000 & LaborForce>10000000), "Mid",
                        ifelse(LaborForce<10000000, "Low","NA")))))

LaborForce_tiers <- LaborForce_tiers %>% 
  group_by(Tier) %>% 
  summarise(NumCountries = n(),
            TotalLaborForce = sum(LaborForce, na.rm=TRUE), .groups="drop") %>% 
  arrange(NumCountries)

tableFunction(LaborForce_tiers, "Labor force Levels")

summary(lf2020_unemployment$LaborForce)
```

As you can see from the Labor Force Levels table, the majority of countries in our data have a Labor Force that is below 10 million people. The majority of countries did not exceed a labor force greater than 20 million as the 5-point summary shows. With this in mind, we are now going to look for a relationship between COVID-19 infection/mortality rates and employment by examining if countries with a larger labor force have higher infection and mortality rates than those with a smaller labor force.


### Approach Used

To determine the relationship between COVID-19 infection/mortality rates and employment, we examined several different data sources. Due to the fact that some of the information provided in the given data sources is incomplete, our analysis is based on the top 50 countries total COVID-19 cases as of October 28, 2020.
The dataframe was developed by combining information from the COVID-19 cases data, with Labor Force levels, government response data, COVID-19 testing statistics, and unemployment percentages.

```{r}

#Take top 50 countries by total number of covid cases at Oct 28, 2020
Oct28covid_cases <- covid_cases %>%
  filter(date == "2020-10-28",
         location != "World") %>%
  select(-c(starts_with("weekly"),starts_with("biweekly")) )%>% 
  arrange(desc(total_cases)) %>%
  slice(1:50) 
```

```{r}
Oct28covid_response<- covid_response %>% 
  filter(Date == "2020-10-28") %>% 
  filter(is.na(RegionCode)) %>% 
  select(CountryName, `C2_Workplace closing`, C2_Flag) 
```

```{r}
filtered_covid_tests <- covid_tests %>% 
  separate(Entity, into = c("Country", "Unit"), sep = " - ") %>% 
  select(c(Country, Date, `Cumulative total`, `Daily change in cumulative total` )) 

filtered_covid_tests$Country <-  str_replace(filtered_covid_tests$Country,"Czechia", "Czech Republic")

daily_covid_tests <- filtered_covid_tests %>% 
  filter(Date <= "2020-10-28") %>% 
  group_by(Country) %>% 
  summarise(DailyTotal = sum(`Daily change in cumulative total`, na.rm=TRUE), .groups =  "drop") 

cumulativetotal_covid_tests <- filtered_covid_tests%>% 
  filter(Date <= "2020-10-28") %>% 
  group_by(Country) %>% 
  summarise(CumulativeTotalTests = max(`Cumulative total`, na.rm=TRUE), .groups= "drop")%>% 
  mutate(CumulativeTotalTests = ifelse(is.finite(CumulativeTotalTests), CumulativeTotalTests, NA))

new_covid_tests <- daily_covid_tests %>% 
  left_join(cumulativetotal_covid_tests, by = "Country") %>% 
  mutate(TotalTests = ifelse(is.na(CumulativeTotalTests), DailyTotal, CumulativeTotalTests)) %>% 
  select(Country, TotalTests)
```

```{r}
Oct28covid_cases_final <- Oct28covid_cases %>% 
  left_join(new_covid_tests, by=c("location" = "Country")) %>%
  left_join(Oct28covid_response, by=c("location" = "CountryName")) %>%
  left_join(lf2020_unemployment, by=c("location" = "Country"))  
```

The COVID-19 pandemic is affecting some regions of the world more severely than others, with some countries total cases being significantly higher than others. The following graph illustrates how a country's labor force contributes to the total number of COVID-19 infections they are experiencing as of October 28,2020.


```{r, fig.width= 8, fig.height= 5, fig.align = "centre"}
ggplot(Oct28covid_cases_final, aes(x=LaborForce, y=total_cases))+
  geom_point(position="jitter")+
  geom_smooth(method="lm")+
  ggtitle("Labor Force by Total Cases")
  
lf_vs_totcase <- lm(Oct28covid_cases_final$total_cases~Oct28covid_cases_final$LaborForce)
summary(lf_vs_totcase)
```

From the illustration we can that as many countries fall into the low tier category of total labor force the number of total cases also is low. Though the graph appears to show a somewhat linear relationship between labor force and total cases, our regression model tells us otherwise. The model's R-squared value shows that 62% of the variation between total cases can be explained by labor force. 62% is more than half but we cannot assume that a higher labor force causes an increase in the total number of cases for a country from this analysis. There are a few countries that have high counts of total cases even though their labor force numbers are not necessarily high. This difference may be able to be explained by the government response of their country and if they decided to close their workplaces.

*Workplace Closing as of Oct28*

With COVID-19 numbers still increasing during October, stricter rules were enforced to ensure people are staying home and avoiding contact with others. This includes the closing of workplaces to reduce the need to leave home. The chart below represents the number of countries that either recommended closing, required closing in some regions or for some workers, or required closing for everyone other than essential workplaces.
- 0 represents the countries that didn't close any workplaces
- 1 represents the countries that recommended that workplaces close or for their staff to work from home
- 2 represents the countries that required some workplaces to close or just some staff to work from home
- 3 represents the countries that closed all workplaces except for the essential workplaces(i.e., grocery stores, hospitals)
- NA is was given to the countries that there wasn't data for

```{r, fig.width = 6, fig.height = 5, fig.align = 'center'}
ggplot(Oct28covid_response,aes(`C2_Workplace closing`))+
  geom_bar(fill = "blue")+
  ggtitle("Levels of Workplace Closure")
```

With COVID-19 incidence now the highest it has ever been, the majority of countries implemented some level of workplace closure to reduce the climbing amount of. If the COVID-19 cases continue to increase in the future, the required workplace closures will likely be continued. This could prove to be costly for many businesses and some will have to close permanently resulting in a rise in the unemployment rate.

### Findings
Based on the results of the data analysis, there seems to be a correlation between employment trends in relation to COVID-19. When examining the COVID data from October 28 and the given data sets, it is hard to draw an accurate conclusion based on the information provided. An assumption that we can make from the trends seen in COVID-19 cases and government responses is that the overall employment rate will decrease as a result of measures taken to control the COVID infection and mortality rates. This occurs because the longer workplaces stay closed, the more money their businesses will lose and eventually they may not be able to afford to stay open. In the data provided we are only given outdated unemployment and youth unemployment rates from before COVID-19 arrived. To be able to come to an accurate conclusion we would need to review how unemployment rates have changed during the time between when the pandemic started and October 28. Therefore, there are no specific recommendations to be made based on this factor alone.



# Technology 

The impact of COVID-19 has played a major role as it relates to technology. It may be assumed that countries with not that much access to the internet or technology may have a challenge as it may be difficult for them to be updated on fatality rates and recoveries within their country and by extension the world. One can assume that for smaller countries persons might be unaware of some of the updates across the world. Hence playing a major role in the technology aspect of things.  

### Data Set Analysis 
* Accesstoelectricity
  - This dataset contains 264 observations and 8 variables. The character variable ‘Country Name’ carries the full name of countries listed in the observations. The character variable “Country Code” has all the abbreviations of the countries that are listed in this dataset. The integer variable “Year” dates the years from 2015-2020 with the last two years containing N/A values and type double variables listed from 2015-2018. Within these variables are columns of persons that have access to electricity as percentage of the population.

* Internetuser
  - This dataset contains 264 observations and 8 variables. This dataset has a similar layout to accesstoelectricity. The character variable ‘Country Name’ contains the full name of countries listed in the observations that use the internet. The character variable ‘Country Code’ has the abbreviations of names within the ‘Country Name’ dataset. What is different with the two datasets is that the integer variable ‘Year’ dates from 2015-2019 have columns with persons who use the internet as a percentage of the population. The remaining year 2020 has N/A values. 


```{r}
#load covid-19 dataset from Oct28
 COVID_casesOct28<-covid_cases %>%  
   filter(date=="2020-10-28", location!="World") %>% 
   select(location, new_cases,new_deaths,total_cases,total_deaths) 
 COVID_cases1OCT28<-COVID_casesOct28 %>%  
  mutate(total_deaths=ifelse(is.na(total_deaths),0,total_deaths), 
        deathrate=(total_deaths/total_cases)*100, 
          recoveryrate=100-deathrate,deathrate=round(deathrate,digits=1), 
     recoveryrate=round(recoveryrate,digits=1)) 
```



```{r}
#load Covid-19 data set from March12  
 COVID_casesMar12<-covid_cases %>% 
   filter(date=="2020-03-12",location!="World",!is.na(total_cases)) %>%  
  select(location, new_cases,new_deaths,total_cases,total_deaths) 
 COVID_cases1Mar12<-COVID_casesMar12 %>%  
     mutate(total_deaths=ifelse(is.na(total_deaths),0,total_deaths), 
     deathrate=(total_deaths/total_cases)*100, 
    recoveryrate=100-deathrate, 
     deathrate=round(deathrate,digits=1), 
     recoveryrate=round(recoveryrate,digits=1)) 
```
 
```{r}
#load data for [Access to electricity (as percentage of population)](https://data.worldbank.org/indicator/EG.ELC.ACCS.ZS)
accesstoelectricity <- read_tsv("ACCESSTOELECTRICITY.csv")


accesstoelectricityfiltered <- accesstoelectricity %>% 
  select(`Country Name`, "2018") %>% 
  rename(Country = "Country Name", electric2018 = "2018") %>% 
  transform(electric2018 = as.integer(electric2018)) 

# Load data for [Individuals using the Internet (as percentage of population)](https://data.worldbank.org/indicator/IT.NET.USER.ZS)
internetuser <- read_tsv("INTERNETUSER.csv")

internetuserfiltered <-internetuser %>% 
  select(Country, "2018") %>% 
  rename(internet2018 = "2018") %>% 
  transform(internet2018= as.integer(internet2018))

            
#combining both datasets 
lfaccess <- internetuserfiltered %>% 
  left_join(accesstoelectricityfiltered, by="Country") %>% 
  # left_join(internetuser, by="Country") %>% 
  select(Country, electric2018, internet2018) %>% 
  na.omit()


```

Diving deeper into the data, we can see which countries have full access and the opportunity to use the internet, those that are in the middle and those who are at the lowest end. For those with low access to electricity, there would expect to be low internet use. 

By examining this access, we can determine during the pandemic who maybe have been getting alerts and news updates within their country.

```{r}
accesstoelectricity_levels <- lfaccess %>% 
  select(Country, electric2018)

accesstoelectricity_levels <- accesstoelectricity_levels %>% 
  mutate(Level = case_when(electric2018 >= 90 ~ "Very High",
    electric2018 >= 70  ~ "High",
    electric2018 >= 50 ~  "Mid",
     TRUE ~ "Low"))
                      

accesstoelectricity_levels <- accesstoelectricity_levels %>% 
  group_by(Level) %>% 
  summarise(NumCountries = n(),
            meanAccesstoelectricity = round(mean(electric2018, na.rm=TRUE), 2), .groups="drop") %>% 
  arrange(desc(meanAccesstoelectricity))

tableFunction(accesstoelectricity_levels, "Access to Electricity Levels")


```

As we can see from the table most countries have a very high level which means they have access to electricity, which should correlate with the opportunity to be high internet users. We can now take this information and investigate how this has impacted the ability of individuals to receive news and COVID-19 updates within  their country, or to be able to work or attend classes remotely in order to reduce mobility within the country.

### Comparisons and Relationships 


```{r}

accesstoelectricity12<- COVID_cases2Mar12 %>% 
    left_join(accesstoelectricityfiltered, by=c("location"="Country"))

accesstoelectricity12<-accesstoelectricity12 %>% 
  filter(!is.na(electric2018))

t1 <- accesstoelectricity12 %>% 
  ggplot(mapping = aes(x=electric2018,y=total_cases))+
  geom_point() +
  geom_smooth(method = "lm") +
  ggtitle("COVID Mar12 Cases and Electricity Access")


```


```{r}
accesstoelectricity28<-left_join(COVID_cases2OCT28,accesstoelectricityfiltered, by=c("location"="Country"))
accesstoelectricity28<-accesstoelectricity28 %>% 
   filter(!is.na(electric2018))
t2 <- accesstoelectricity28 %>% 
  ggplot(mapping = aes(x=electric2018,y=total_cases))+
  geom_point()+
  geom_smooth(method='lm') +
  ggtitle("COVID Oct28 Cases and Electricity Access")
```


```{r, fig.width= 8, fig.height= 6}
grid.arrange(t1, t2, ncol=1)
```



```{r}

internetuser12<-left_join(COVID_cases2Mar12,internetuserfiltered,by=c("location"="Country"))
internetuser12<- internetuser12%>% 
  filter(!is.na(internet2018))
t3 <- internetuser12 %>% 
  ggplot(mapping=aes(x=internet2018,y=total_cases))+
  geom_point()+
  geom_smooth(method = 'lm') +
  ggtitle("COVID Mar12 Cases vs Internet Access")

```



```{r}
internetuser28<-left_join(COVID_cases2OCT28,internetuserfiltered,by=c("location"="Country"))
internetuser28<- internetuser28 %>% 
  filter(!is.na(internet2018))
t4 <- internetuser28 %>% 
  ggplot(mapping=aes(x=internet2018))+
  geom_point(mapping = aes(y=total_cases))+
  geom_smooth(mapping=aes(y=total_cases),method = 'lm') +
  ggtitle("COVID Oct28 Cases vs Internet Access")
```


```{r,fig.width= 8, fig.height= 4}
grid.arrange(t3, t4, ncol = 2)
```

### Findings
There appears to be a positive relationship between level of technology and incidence of COVID-19 cases. This is stronger in the early phase of the pandemic compared to the later periods. This may be due to the fact that information on the virus was limited at first but this improved over time. However, as people became better informed, they were able to take proper precautions.



# Combining Factors

While each of the factors analyzed may have had some relationship with overall infection rate, it is also possible that there is a combined impact. 

```{r, echo = FALSE, fig.width = 9, fig.height=6}
combineddata <- covid_top60 %>% 
  select(location, NewMortRate, NewInfRate, Score, StringencyIndex) %>% 
  left_join(educationexp1, by = c("location" = "Country")) %>% 
  left_join(healthexp2, by = c("location" = "Country")) %>% 
  left_join(Oct28covid_cases_final, by = "location") %>% 
  left_join(internetuserfiltered, by = c("location" = "Country"))

combineddate <- combineddata %>% 
  select(c(location, NewMortRate, NewInfRate, StringencyIndex, Score, percentGDP, Healthexpenditure, UnempRate, LaborForce, internet2018))

combined_model <- lm(NewInfRate ~   percentGDP*UnempRate + Score + internet2018, data = combineddata)

comb_model <- combined_model %>% glance() %>% tidy()

comb_model<- comb_model %>% 
  select(column, mean) %>% 
  rename("Statistic" = column,
         "Value" = mean)

tableFunction(comb_model, "Combined Model Statistics")
combinedresults <- combineddata %>% 
  select(c(location, NewInfRate, Score, percentGDP, UnempRate, internet2018)) %>% 
  add_residuals(combined_model) %>% 
  add_predictions(combined_model)


```



When combining the several factors we discussed into a single model, including interactions between variables, there appears to be a slightly better, with the model explaining only about 36% of the variation in new infection rates among countries. This may be due to factors that are not captured in the model, such as population demographics.


  
# Conclusion and Recommendations

While there are some relationships between each of the factors explored and the level of infection within a country, it is not possible to conclude that any specific factor or combination of factors can accurately model this rate. One challenge we encountered in our analysis was with the data. Quite often data was incomplete or outdated, particularly for information on each country's economic and employment statistics. Additional factors can be explored to help improve the model.

However, the analysis showed that while different government systems responded in some way to the pandemic, the severity of these responses varied, as well as the level of enforcement. In addition, while some countries may have been in a more stable economic position prior to the pandemic, this did not mean that they were able to have much of an advantage in controlling its spread. The size of the labour force, as well as unemployment rates did not seem to impact the spread of the disease, although it is likely that unemployment rates will increase as a result. Finally, the level of technology as determined by availability of electricity and access to the internet impacted whether governments were able to broadcast information to the population in a timely and efficient manner.


# Appendix

### Data Sources

- https://www.who.int/emergencies/diseases/novel-coronavirus-2019

- Covid-19 cases :
https://covid.ourworldindata.org/data/ecdc/full_data.csv

- Covid-19 testing :
https://covid.ourworldindata.org/data/testing/covid-testing-all-observations.csv

- COVID-19 government responses:
https://www.bsg.ox.ac.uk/research/research-projects/coronavirus-government-response-tracker#data [codebook] https://raw.githubusercontent.com/OxCGRT/covid-policy-tracker/master/data/OxCGRT_latest.csv to understand the meanings of the values

- Democracy index:
https://www.eiu.com/topic/democracy-index developed by the [Economist Intelligence Unit] http://www.eiu.com/home.aspx , which is contained in the table from the Wikipedia page (https://en.wikipedia.org/wiki/Democracy_Index).

- Population index:
https://www.cia.gov/library/publications/resources/the-world-factbook/fields/335rank.html

- Health 
https://www.cia.gov/library/publications/resources/the-world-factbook/fields/409.html

- Education
https://www.cia.gov/library/publications/resources/the-world-factbook/rankorder/2206rank.html

- LaborForce
https://data.worldbank.org/indicator/SL.TLF.TOTL.IN : the up-to-date data we use. [CIA] https://www.cia.gov/library/publications/resources/the-world-factbook/fields/218rank.html : has a slightly outdated data set.

- Unemp
https://www.cia.gov/library/publications/resources/the-world-factbook/fields/220rank.html

- Unempyouth
https://www.cia.gov/library/publications/resources/the-world-factbook/fields/373rank.html

- AccesstoElectricity
https://data.worldbank.org/indicator/EG.ELC.ACCS.ZS

- InternetUsers
https://data.worldbank.org/indicator/IT.NET.USER.ZS
